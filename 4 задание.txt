#include <iostream>
#include <time.h>

using namespace std;

const int len1 = 10;

int main() {
    int len2{};
    char board[len1][len1]{};
    bool flip[len1][len1]{};
    int flip_q{};
    int cards{};
    int same{};
    int turn_q{};

    cout << "Enter the board size from 2 to " << len1 << ": ";
    cin >> len2;


    if (len2 < 2 || len2 > len1) {
        cout << "Invalid board size. Game stoped" << endl;
        return 0;
    }


    cards = len2 * len2;


    for (int i = 0; i < len2; ++i) {
        for (int j = 0; j < len2; ++j) {
            board[i][j] = ' ';
            flip[i][j] = false;
        }
    }


    srand(time(0));
    char current= 'A';

    for (int i = 0; i < cards / 2; ++i) {
        for (int j = 0; j < 2; ++j) {
            int row, col;


            do {
                row = rand() % len2;
                col = rand() % len2;
            } while (board[row][col] != ' ');


            board[row][col] = current;
        }

        ++current;
    }
int start = time(0);

    while (same < cards / 2) {

        cout << "  ";
        for (int j = 0; j < len2; ++j) {
            cout << j + 1 << ' ';
        }
        cout << endl;

        for (int i = 0; i < len2; ++i) {
            cout << i + 1 << ' ';
            for (int j = 0; j < len2; ++j) {
                if (flip[i][j]) {
                    cout << board[i][j] << ' ';
                } else {
                    cout << "# ";
                }
            }
            cout << endl;
        }


        int row{}, col{};
        cout << "Enter row: ";
        cin >> row;
        cout << "Enter column: ";
        cin >> col;


        if (row < 1 || row > len2 || col < 1 || col > len2) {
            cout << "Invalid coordinates.Try again" << endl;
            continue;
        }

        --row;
        --col;


        if (flip[row][col]) {
            cout << "The chosen card is already flipped.Try again" << endl;
            continue;
        }


        flip[row][col] = true;


        ++flip_q;


        cout << "Flipped card: " << board[row][col] << endl;


        if (flip_q == 2) {
            ++turn_q;
            int card_row = -1, card_col = -1;


            for (int i = 0; i < len2; ++i) {
                for (int j = 0; j < len2; ++j) {
                    if (flip[i][j]) {
                        if (card_row == -1 && card_col == -1) {
                            card_row = i;
                            card_col = j;
                        } else {
                            if (board[i][j] == board[card_row][card_col]) {
                                cout << "Pair found" << endl;
                                flip[i][j] = true;
                                ++same;
                            } else {
                                cout << "Pair not found.Cards flipped back" << endl;
                                flip[i][j] = false;
                                flip[card_row][card_col] = false;
                            }

                            flip_q = 0;
                            break;
                        }
                    }
                }

                if (flip_q == 0) {
                    break;
                }
            }
        }

        cout << endl;
    }
     int stop = time(0);
    
    cout << "You found all the card pairs" << endl;
    cout << "Number of card flips: " << turn_q << endl;
    int time = stop - start;
    cout << "Game time: " << time << " seconds" << endl;

    return 0;
}
